"use strict";(self.webpackChunktalking_web=self.webpackChunktalking_web||[]).push([[477],{477:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var n=s(555),a=s(43),i=s(791),l=s(472),d=s(579);const r=()=>{const[e,t]=(0,a.useState)({}),[s,r]=(0,a.useState)([]),[c,o]=(0,a.useState)({dueDate:"5",autoReset:!1,reminderDays:"2"}),[h,u]=(0,a.useState)([]),[x,j]=(0,a.useState)("");(0,a.useEffect)((()=>{(async()=>{const e=i.j.currentUser;if(e)try{const s=(0,l.H9)(i.db,"admins",e.uid),a=(0,l.rJ)(i.db,"flats"),d=(0,l.rJ)(i.db,"notificationTemplates"),[c,o,h]=await Promise.all([(0,l.x7)(s),(0,l.GG)(a),(0,l.GG)(d)]);c.exists()&&t(c.data()),r(o.docs.map((e=>(0,n.A)({id:e.id},e.data())))),u(h.docs.map((e=>(0,n.A)({id:e.id},e.data()))))}catch(s){console.error("Error fetching settings:",s),j("\u274c Failed to load settings.")}})()}),[]);const m=s=>{t((0,n.A)((0,n.A)({},e),{},{[s.target.name]:s.target.value}))};return(0,d.jsxs)("div",{className:"admin-settings",children:[(0,d.jsx)("h2",{children:"\u2699\ufe0f Admin Settings"}),x&&(0,d.jsx)("div",{className:"message-box",children:x}),(0,d.jsxs)("section",{children:[(0,d.jsx)("h3",{children:"\ud83e\uddd1\u200d\ud83d\udcbc Admin Profile"}),(0,d.jsxs)("label",{children:["Name: ",(0,d.jsx)("input",{name:"name",value:e.name||"",onChange:m})]}),(0,d.jsxs)("label",{children:["Email: ",(0,d.jsx)("input",{value:e.email||"",disabled:!0})]}),(0,d.jsxs)("label",{children:["Phone: ",(0,d.jsx)("input",{name:"phone",value:e.phone||"",onChange:m})]}),(0,d.jsxs)("label",{children:["UPI ID: ",(0,d.jsx)("input",{name:"upi",value:e.upi||"",onChange:m})]}),(0,d.jsx)("button",{onClick:async()=>{try{const t=(0,l.H9)(i.db,"admins",i.j.currentUser.uid);await(0,l.mZ)(t,e),j("\u2705 Profile updated")}catch(t){console.error(t),j("\u274c Failed to update profile.")}},children:"\ud83d\udcbe Save Profile"}),(0,d.jsx)("button",{onClick:()=>i.j.sendPasswordResetEmail(e.email),children:"\ud83d\udd10 Reset Password"})]}),(0,d.jsxs)("section",{children:[(0,d.jsx)("h3",{children:"\ud83c\udfd8\ufe0f Flat Settings"}),(0,d.jsxs)("table",{children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"Flat"}),(0,d.jsx)("th",{children:"Rent"}),(0,d.jsx)("th",{children:"Status"}),(0,d.jsx)("th",{children:"Action"})]})}),(0,d.jsx)("tbody",{children:s.map((e=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:e.flatNumber}),(0,d.jsxs)("td",{children:["\u20b9",e.rent]}),(0,d.jsx)("td",{children:e.status}),(0,d.jsxs)("td",{children:[(0,d.jsx)("button",{children:"Edit"}),(0,d.jsx)("button",{onClick:()=>(0,l.kd)((0,l.H9)(i.db,"flats",e.id)),children:"Delete"})]})]},e.id)))})]}),(0,d.jsx)("button",{children:"\u2795 Add Flat"})]}),(0,d.jsxs)("section",{children:[(0,d.jsx)("h3",{children:"\ud83d\udcc5 Rent Cycle Settings"}),(0,d.jsxs)("label",{children:["Due Date:",(0,d.jsx)("input",{type:"number",value:c.dueDate,onChange:e=>o((0,n.A)((0,n.A)({},c),{},{dueDate:e.target.value}))})]}),(0,d.jsxs)("label",{children:["Auto Reset:",(0,d.jsx)("input",{type:"checkbox",checked:c.autoReset,onChange:e=>o((0,n.A)((0,n.A)({},c),{},{autoReset:e.target.checked}))})]}),(0,d.jsxs)("label",{children:["Reminder Days Before:",(0,d.jsx)("input",{type:"number",value:c.reminderDays,onChange:e=>o((0,n.A)((0,n.A)({},c),{},{reminderDays:e.target.value}))})]}),(0,d.jsx)("button",{onClick:async()=>{try{const e=(0,l.H9)(i.db,"settings","rentCycle");await(0,l.BN)(e,c),j("\u2705 Rent cycle updated")}catch(e){j("\u274c Rent cycle update failed.")}},children:"\ud83d\udcbe Update Rent Cycle"})]}),(0,d.jsxs)("section",{children:[(0,d.jsx)("h3",{children:"\ud83d\udce8 Notification Templates"}),(0,d.jsx)("ul",{children:h.map((e=>(0,d.jsxs)("li",{children:[(0,d.jsx)("strong",{children:e.name}),": ",e.message,(0,d.jsx)("button",{children:"Edit"}),(0,d.jsx)("button",{onClick:()=>(0,l.kd)((0,l.H9)(i.db,"notificationTemplates",e.id)),children:"Delete"})]},e.id)))}),(0,d.jsx)("button",{children:"\u2795 Add Template"})]}),(0,d.jsxs)("section",{className:"danger-zone",children:[(0,d.jsx)("h3",{children:"\u2757 Danger Zone"}),(0,d.jsx)("button",{onClick:async()=>{try{const e=(0,l.rJ)(i.db,"users"),t=(await(0,l.GG)(e)).docs.map((async e=>{"tenant"===e.data().role&&await(0,l.mZ)((0,l.H9)(i.db,"users",e.id),{rentStatus:"Unpaid"})}));await Promise.all(t),j("\u26a0\ufe0f Rent statuses reset for all tenants")}catch(e){console.error(e),j("\u274c Failed to reset rent statuses")}},children:"\u274c Reset All Rent Statuses"}),(0,d.jsx)("button",{children:"\u274c Delete Tenant"}),(0,d.jsx)("button",{children:"\u274c Reset All Flat Data"})]})]})}}}]);
//# sourceMappingURL=477.8584e1fd.chunk.js.map