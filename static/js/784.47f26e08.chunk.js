"use strict";(self.webpackChunktalking_web=self.webpackChunktalking_web||[]).push([[784],{784:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var s=a(43),n=a(791),i=a(472),l=a(579);const r=()=>{const[e,t]=(0,s.useState)(null),[a,r]=(0,s.useState)(!0),[o,c]=(0,s.useState)("UPI"),[d,h]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[x,j]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null),[y,g]=(0,s.useState)("");(0,s.useEffect)((()=>{(async()=>{const e=n.j.currentUser;if(e)try{const a=(0,i.H9)(n.db,"users",e.uid),s=await(0,i.x7)(a);if(s.exists()){const e=s.data();t(e),j("Paid"===e.rentStatus)}}catch(a){g("Failed to load tenant data.")}finally{r(!1)}})()}),[]);if(a)return(0,l.jsx)("div",{className:"loader",children:"Loading payment info..."});if(!e)return(0,l.jsx)("div",{className:"error-box",children:"Tenant data not found."});const{name:v,flatNumber:P,rentAmount:w,electricityBill:N,rentDueDate:b}=e,D=w+((null===N||void 0===N?void 0:N.amount)||0);return(0,l.jsxs)("div",{className:"rent-payment",children:[(0,l.jsx)("h2",{children:"\ud83d\udcb3 Rent Payment"}),(0,l.jsx)("p",{className:"subtitle",children:"Pay your monthly rent and utility charges"}),(0,l.jsxs)("div",{className:"tenant-info",children:[(0,l.jsxs)("p",{children:["\ud83d\udc64 ",(0,l.jsx)("strong",{children:"Name:"})," ",v]}),(0,l.jsxs)("p",{children:["\ud83c\udfe0 ",(0,l.jsx)("strong",{children:"Flat:"})," ",P]}),(0,l.jsxs)("p",{children:["\ud83d\udcc5 ",(0,l.jsx)("strong",{children:"Month:"})," July 2025"]})]}),(0,l.jsxs)("div",{className:"payment-breakdown",children:[(0,l.jsx)("h3",{children:"\ud83d\udccb Payment Breakdown"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:["Rent: \u20b9",w]}),(0,l.jsxs)("li",{children:["Electricity: \u20b9",(null===N||void 0===N?void 0:N.amount)||0]}),(0,l.jsx)("li",{children:"Other Charges: \u20b90"})]}),(0,l.jsx)("hr",{}),(0,l.jsxs)("p",{className:"total-due ".concat(x?"paid":"due"),children:["\ud83d\udd22 Total Due: \u20b9",D]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Due Date:"})," ",b]})]}),x?(0,l.jsx)("div",{className:"paid-box",children:"\u2705 You've already paid for July."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"payment-method",children:[(0,l.jsx)("h4",{children:"\ud83d\udcb3 Select Payment Method"}),(0,l.jsxs)("select",{value:o,onChange:e=>c(e.target.value),children:[(0,l.jsx)("option",{value:"UPI",children:"UPI"}),(0,l.jsx)("option",{value:"Bank Transfer",children:"Bank Transfer"}),(0,l.jsx)("option",{value:"Cash",children:"Cash"})]}),"UPI"===o&&(0,l.jsxs)("p",{className:"upi-info",children:["Send to UPI ID: ",(0,l.jsx)("strong",{children:"myflats@upi"})]})]}),(0,l.jsxs)("div",{className:"upload-proof",children:[(0,l.jsx)("h4",{children:"\ud83d\udce4 Upload Payment Proof (Optional)"}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t&&t.type.startsWith("image/")){const e=new FileReader;e.onloadend=()=>{m(e.result),h(e.result)},e.readAsDataURL(t)}else g("Please select a valid image file.")}}),u&&(0,l.jsx)("img",{src:u,alt:"Preview",width:"200"})]}),(0,l.jsx)("button",{className:"pay-btn",onClick:async()=>{if(e){g(""),r(!0);try{var t;const a=e.rentAmount+((null===(t=e.electricityBill)||void 0===t?void 0:t.amount)||0),s="TXN".concat(Date.now()),l=n.j.currentUser.uid;await(0,i.BN)((0,i.H9)(n.db,"payments",s),{uid:l,name:e.name,flat:e.flatNumber,amount:a,method:o,month:"July 2025",proofBase64:d||"",date:(new Date).toLocaleDateString(),timestamp:(0,i.O5)()}),await(0,i.mZ)((0,i.H9)(n.db,"users",l),{rentStatus:"Paid"}),f({id:s,amount:a,date:(new Date).toLocaleDateString(),proofBase64:d}),j(!0)}catch(a){console.error(a),g("Payment failed. Please try again.")}finally{r(!1)}}},disabled:a,children:a?"Processing...":"Pay \u20b9".concat(D," Now")})]}),p&&(0,l.jsxs)("div",{className:"receipt-box",children:[(0,l.jsx)("h4",{children:"\ud83d\udcc4 Payment Receipt"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Receipt ID:"})," ",p.id]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Amount:"})," \u20b9",p.amount]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Date:"})," ",p.date]}),p.proofBase64&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:"Proof of Payment:"})}),(0,l.jsx)("img",{src:p.proofBase64,alt:"Proof of Payment",width:"200"})]}),(0,l.jsx)("button",{onClick:()=>window.location.href="/history",children:"View Payment History"})]}),y&&(0,l.jsx)("div",{className:"error-box",children:y})]})}}}]);
//# sourceMappingURL=784.47f26e08.chunk.js.map